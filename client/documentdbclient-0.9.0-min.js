(function(){function u(n,t,i){for(var s=Object.keys(t),u,e=0,h=s.length;e<h;e++){var f=s[e],o=f.charCodeAt(0)!==95,r=t[f];if(r&&typeof r=="object"&&(r.value!==undefined||typeof r.get=="function"||typeof r.set=="function")){r.enumerable===undefined&&(r.enumerable=o);i&&r.setName&&typeof r.setName=="function"&&r.setName(i+"."+f);u=u||{};u[f]=r;continue}if(!o){u=u||{};u[f]={value:r,enumerable:o,configurable:!0,writable:!0};continue}n[f]=r}u&&Object.defineProperties(n,u)}function o(n,t,i){var r=n||{},o,f,s,e;if(t)for(o=t.split("."),f=0,s=o.length;f<s;f++)e=o[f],r[e]||Object.defineProperty(r,e,{value:{},writable:!1,enumerable:!0,configurable:!0}),r=r[e];return i&&u(r,i,t||"<ANONYMOUS>"),r}function l(n,t){return o(undefined,n,t)}function s(n,t,i){return n=n||function(){},t&&u(n.prototype,t),i&&u(n,i),n}function a(n,t,i,r){if(n){t=t||function(){};var f=n.prototype;return t.prototype=Object.create(f),Object.defineProperty(t.prototype,"constructor",{value:t,writable:!0,configurable:!0,enumerable:!0}),i&&u(t.prototype,i),r&&u(t,r),t}return s(t,i,r)}function v(n){n=n||function(){};for(var t=1,i=arguments.length;t<i;t++)u(n.prototype,arguments[t]);return n}var c=this,r={};r.createClient=function(n,t,i,r){return new y(n,t,i,r)};c.DocumentDB=r;var n={NotImplementedException:"NotImplementedException",defineWithParent:o,define:l,defineClass:s,derive:a,mix:v,extend:function(n,t){for(var i in t)typeof t[i]!="function"&&(n[i]=t[i]);return n},map:function(n,t){for(var r=[],i=0,u=n.length;i<u;i++)r.push(t(n[i]));return r},getHeaders:function(i,r,u,f,e,o,s){var c=n.extend({},r);return s=s||{},s.continuation&&(c[t.HttpHeaders.Continuation]=s.continuation),s.preTriggerInclude&&(c[t.HttpHeaders.PreTriggerInclude]=s.preTriggerInclude.constructor===Array?s.preTriggerInclude.join(","):s.preTriggerInclude),s.postTriggerInclude&&(c[t.HttpHeaders.PostTriggerInclude]=s.postTriggerInclude.constructor===Array?s.postTriggerInclude.join(","):s.postTriggerInclude),s.maxItemCount&&(c[t.HttpHeaders.PageSize]=s.maxItemCount),s.accessCondition&&(s.accessCondition.type==="IfMatch"?c[t.HttpHeaders.IfMatch]=s.accessCondition.condition:c[t.HttpHeaders.IfNoneMatch]=s.accessCondition.condition),s.indexingDirective&&(c[t.HttpHeaders.IndexingDirective]=s.indexingDirective),s.consistencyLevel&&(c[t.HttpHeaders.ConsistencyLevel]=s.consistencyLevel),s.resourceTokenExpirySeconds&&(c[t.HttpHeaders.ResourceTokenExpiry]=s.resourceTokenExpirySeconds),s.sessionToken&&(c[t.HttpHeaders.SessionToken]=s.sessionToken),i.masterKey&&(c[t.HttpHeaders.XDate]=(new Date).toUTCString()),(i.masterKey||i.resourceTokens)&&(c[t.HttpHeaders.Authorization]=encodeURIComponent(h.getAuthorizationHeader(i,u,f,e,o,c))),(u==="post"||u==="put")&&(c[t.HttpHeaders.ContentType]||(c[t.HttpHeaders.ContentType]=t.MediaTypes.Json)),c[t.HttpHeaders.Accept]||(c[t.HttpHeaders.Accept]=t.MediaTypes.Json),c},parsePath:function(n){var t,i,r;return n[n.length-1]!=="/"&&(n=n+"/"),n[0]!=="/"&&(n="/"+n),t=n.split("/"),t.length%2==0?(i=t[t.length-2],r=t[t.length-3]):(i=t[t.length-3],r=t[t.length-2]),{type:r,objectBody:{id:i,self:n}}},getAttachmentIdFromMediaId:function(n){var t=new Buffer(n,"base64"),i=20;return t.length>i?t.toString("base64",0,i):n},getHexaDigit:function(){return Math.floor(Math.random()*16).toString(16)},generateGuidId:function(){for(var i="",t=0;t<8;t++)i+=n.getHexaDigit();for(i+="-",t=0;t<4;t++)i+=n.getHexaDigit();for(i+="-",t=0;t<4;t++)i+=n.getHexaDigit();for(i+="-",t=0;t<4;t++)i+=n.getHexaDigit();for(i+="-",t=0;t<12;t++)i+=n.getHexaDigit();return i}},t={MediaTypes:{Any:"*/*",Json:"application/json",Xml:"application/xml",OctetStream:"application/octet-stream",SQL:"application/sql",ImageJpeg:"image/jpeg",ImagePng:"image/png",TextHtml:"text/html",TextPlain:"text/plain",Javascript:"application/x-javascript"},HttpMethods:{Get:"GET",Post:"POST",Put:"PUT",Delete:"DELETE",Head:"HEAD",Options:"OPTIONS"},HttpHeaders:{Authorization:"authorization",ETag:"etag",MethodOverride:"X-HTTP-Method",Slug:"Slug",ContentType:"Content-Type",LastModified:"Last-Modified",ContentEncoding:"Content-Encoding",CharacterSet:"CharacterSet",UserAgent:"User-Agent",IfModified_since:"If-Modified-Since",IfMatch:"If-Match",IfNoneMatch:"If-None-Match",ContentLength:"Content-Length",AcceptEncoding:"Accept-Encoding",KeepAlive:"Keep-Alive",CacheControl:"Cache-Control",TransferEncoding:"Transfer-Encoding",ContentLanguage:"Content-Language",ContentLocation:"Content-Location",ContentMd5:"Content-Md5",ContentRange:"Content-Range",Accept:"Accept",AcceptCharset:"Accept-Charset",AcceptLanguage:"Accept-Language",IfRange:"If-Range",IfUnmodifiedSince:"If-Unmodified-Since",MaxForwards:"Max-Forwards",ProxyAuthorization:"Proxy-Authorization",AcceptRanges:"Accept-Ranges",ProxyAuthenticate:"Proxy-Authenticate",RetryAfter:"Retry-After",SetCookie:"Set-Cookie",WwwAuthenticate:"Www-Authenticate",Origin:"Origin",Host:"Host",AccessControlAllowOrigin:"Access-Control-Allow-Origin",AccessControlAllowHeaders:"Access-Control-Allow-Headers",KeyValueEncodingFormat:"application/x-www-form-urlencoded",WrapAssertionFormat:"wrap_assertion_format",WrapAssertion:"wrap_assertion",WrapScope:"wrap_scope",SimpleToken:"SWT",HttpDate:"date",Prefer:"Prefer",Location:"Location",Referer:"referer",Query:"x-ms-documentdb-query",IsQuery:"x-ms-documentdb-isquery",Continuation:"x-ms-continuation",PageSize:"x-ms-max-item-count",ActivityId:"x-ms-activity-id",PreTriggerInclude:"x-ms-documentdb-pre-trigger-include",PreTriggerExclude:"x-ms-documentdb-pre-trigger-exclude",PostTriggerInclude:"x-ms-documentdb-post-trigger-include",PostTriggerExclude:"x-ms-documentdb-post-trigger-exclude",IndexingDirective:"x-ms-indexing-directive",SessionToken:"x-ms-session-token",ConsistencyLevel:"x-ms-consistency-level",XDate:"x-ms-date",CollectionPartitionInfo:"x-ms-collection-partition-info",CollectionServiceInfo:"x-ms-collection-service-info",RetryAfterInMilliseconds:"x-ms-retry-after-ms",IsFeedUnfiltered:"x-ms-is-feed-unfiltered",ResourceTokenExpiry:"x-ms-documentdb-expiry-seconds",Version:"x-ms-version",MaxEntityCount:"x-ms-root-entity-max-count",CurrentEntityCount:"x-ms-root-entity-current-count",CollectionQuotaInMb:"x-ms-collection-quota-mb",CollectionCurrentUsageInMb:"x-ms-collection-usage-mb",MaxMediaStorageUsageInMB:"x-ms-max-media-storage-usage-mb",CurrentMediaStorageUsageInMB:"x-ms-media-storage-usage-mb",DatabaseAccountCapacityUnitsConsumed:"x-ms-database-capacity-units-consumed",DatabaseAccountCapacityUnitsProvisioned:"x-ms-database-capacity-units-provisioned",DatabaseAccountConsumedDocumentStorageInMB:"x-ms-databaseaccount-consumed-mb",DatabaseAccountReservedDocumentStorageInMB:"x-ms-databaseaccount-reserved-mb",DatabaseAccountProvisionedDocumentStorageInMB:"x-ms-databaseaccount-provisioned-mb",RequestCharge:"x-ms-request-charge"},CurrentVersion:"2014-08-21",UserAgent:"documentdb-nodejs-sdk-0.9.0"},i=n.defineClass(function(n,t,i,r){this.documentclient=n;this.query=t;this.resources=[];this.current=0;this.fetchFunction=r;this.continuation=null;this.options=i||{};this._states=Object.freeze({start:"start",inProgress:"inProgress",ended:"ended"});this._state=this._states.start},{forEach:function(n){this._state!==this._states.start&&this.reset();this._forEachImplementation(n)},nextItem:function(n){var t=this;if(this.current<this.resources.length)return n(undefined,this.resources[this.current++]);this._state===this._states.start||this.continuation&&this._state===this._states.inProgress?this._fetchMore(function(i,r){if(i)return n(i);if(t.resources=r,t.resources.length===0){if(t.continuation){t.nextItem(n);return}t._state=t._states.ended;n(undefined,undefined);return}n(undefined,t.resources[t.current++])}):(this._state=this._states.ended,n(undefined,undefined))},current:function(){return this.resources[this.current]},hasMoreResults:function(){return this._state===this._states.start||this.continuation!==undefined||this.current<this.resources.length},toArray:function(n){this._state!==this._states.start&&this.reset();this._toArrayImplementation(n)},executeNext:function(n){var t=this;this._fetchMore(function(t,i,r){if(t)return n(t);n(undefined,i,r)})},reset:function(){this.current=0;this.continuation=null;this.resources=[];this._state=this._states.start},_toArrayImplementation:function(n){var t=this;this._state===this._states.start||this.continuation&&this._state===this._states.inProgress?this._fetchMore(function(i,r){if(i)return n(i);t.resources=t.resources.concat(r);t._toArrayImplementation(n)}):(this._state=this._states.ended,n(undefined,this.resources))},_forEachImplementation:function(n){var t=this;this._state===this._states.start||this.continuation&&this._state===this._states.inProgress?this._fetchMore(function(i,r){if(i)return n(i);for(t.resources=r;t.current<t.resources.length;)if(n(undefined,t.resources[t.current++])===!1)return;t._forEachImplementation(n)}):(t._state=t._states.ended,n(undefined,undefined))},_fetchMore:function(n){var i=this;this.options.continuation=this.continuation;this.fetchFunction(this.options,function(r,u,f){if(r)return i._state=i._states.ended,n(r);i.continuation=f[t.HttpHeaders.Continuation];i._state=i._states.inProgress;i.current=0;n(undefined,u,f)})}}),f=n.defineClass(null,null,{DatabaseAccount:n.defineClass(function(){Object.defineProperty(this,"DatabasesLink",{value:"",writable:!0,configurable:!0,enumerable:!0});Object.defineProperty(this,"MediaLink",{value:"",writable:!0,configurable:!0,enumerable:!0});Object.defineProperty(this,"MaxMediaStorageUsageInMB",{value:0,writable:!0,configurable:!0,enumerable:!0});Object.defineProperty(this,"CurrentMediaStorageUsageInMB",{value:0,writable:!0,configurable:!0,enumerable:!0});Object.defineProperty(this,"CapacityUnitsConsumed",{value:0,writable:!0,configurable:!0,enumerable:!0});Object.defineProperty(this,"CapacityUnitsProvisioned",{value:0,writable:!0,configurable:!0,enumerable:!0});Object.defineProperty(this,"ConsumedDocumentStorageInMB",{value:0,writable:!0,configurable:!0,enumerable:!0});Object.defineProperty(this,"ReservedDocumentStorageInMB",{value:0,writable:!0,configurable:!0,enumerable:!0});Object.defineProperty(this,"ProvisionedDocumentStorageInMB",{value:0,writable:!0,configurable:!0,enumerable:!0});Object.defineProperty(this,"ConsistencyPolicy",{value:"",writable:!0,configurable:!0,enumerable:!0})}),ConsistencyLevel:Object.freeze({Strong:"Strong",BoundedStaleness:"BoundedStaleness",Session:"Session",Eventual:"Eventual"}),IndexingMode:Object.freeze({Consistent:"consistent",Lazy:"lazy"}),IndexType:Object.freeze({Hash:"Hash",Range:"Range"}),Protocol:Object.freeze({Tcp:1,Https:2}),ConnectionMode:Object.freeze({Direct:0,Gateway:1}),MediaReadMode:Object.freeze({Buffered:"Buffered",Streamed:"Streamed"}),PermissionMode:Object.freeze({None:"none",Read:"read",All:"all"}),TriggerType:Object.freeze({Pre:"pre",Post:"post"}),TriggerOperation:Object.freeze({All:"all",Create:"create",Update:"update",Delete:"delete",Replace:"replace"}),UserDefinedFunctionType:Object.freeze({Javascript:"Javascript"}),ConnectionPolicy:n.defineClass(function(){Object.defineProperty(this,"_defaultMaxConnections",{value:20,writable:!0,configurable:!0,enumerable:!1});Object.defineProperty(this,"_defaultMaxConcurrentCallsPerConnection",{value:50,writable:!0,configurable:!0,enumerable:!1});Object.defineProperty(this,"_defaultRequestTimeout",{value:1e4,writable:!0,configurable:!0,enumerable:!1});Object.defineProperty(this,"_defaultMediaRequestTimeout",{value:3e5,writable:!0,configurable:!0,enumerable:!1});this.ConnectionMode=f.ConnectionMode.Gateway;this.ConnectionProtocol=f.Protocol.Https;this.MediaReadMode=f.MediaReadMode.Buffered;this.MediaRequestTimeout=this._defaultMediaRequestTimeout;this.RequestTimeout=this._defaultRequestTimeout;this.MaxCallsPerConnections=this._defaultMaxConcurrentCallsPerConnection;this.MaxConnections=this._defaultMaxConnections})}),e={_createXmlHttpRequest:function(){if(window.XMLHttpRequest)return new window.XMLHttpRequest;var n;if(window.ActiveXObject)try{return new window.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(i){try{return new window.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){n=t}}else n={message:"XMLHttpRequest not supported"};throw n;},_readResponseHeaders:function(n,t){var f=n.getAllResponseHeaders(),r,i,e,u;if(f)for(r=f.split(/\r?\n/),i=0,e=r.length;i<e;i++)r[i]&&(u=r[i].split(": "),t[u[0]]=u[1])},_addRequestHeaders:function(n,t){if(t)for(var i in t)n.setRequestHeader(i,t[i])},_preProcessUrl:function(n,t,i){return t=t||"",i=i||"",n+t+"?"+i},request:function(n,t,i,r,u,f,e,o){var l={},s=null,c,h,a,v;return i=this._preProcessUrl(i,r,f),c=r.indexOf("media")>-1,h=!1,l.abort=function(){h||(h=!0,s&&(s.abort(),s=null),o({message:"Request aborted"}))},a=function(){h||(h=!0,s=null,o({message:"Request timed out"}))},s=this._createXmlHttpRequest(),v=this,s.onreadystatechange=function(){var r,n,i,t,u;if(!h&&s!==null&&s.readyState===4){if(r=s.statusText,n=s.status,n===1223&&(n=204,r="No Content"),i={},v._readResponseHeaders(s,i),t=s.responseText,h=!0,s=null,n>=300)return o({code:n,body:t});try{u=c?t:t.length>0?JSON.parse(t):undefined}catch(f){return o(f)}return o(undefined,u,i)}},s.open(t||"GET",i,!0),this._addRequestHeaders(s,e),s.timeout=c?n.MediaRequestTimeout:n.RequestTimeout,s.ontimeout=a,typeof u=="object"&&(u=JSON.stringify(u)),s.send(u),l}},h={getAuthorizationHeader:function(n,t,i,r,u,f){return n.resourceTokens?this.getAuthorizationTokenUsingResourceTokens(n.resourceTokens,i,r):n.masterKey?this.getAuthorizationTokenUsingMasterKey(t,r,u,f,n.masterKey):""},getAuthorizationTokenUsingMasterKey:function(){throw"Authentication for javascript client doesn't currently support master key, please use resource tokens instead";},getAuthorizationTokenUsingResourceTokens:function(n,t,i){var u,f,r;if(n[i])return n[i];for(u=t.split("/"),f=["dbs","colls","docs","sprocs","udfs","triggers","users","permissions","attachments","media","conflicts"],r=u.length-1;r>=0;r--)if(f.indexOf(u[r])===-1&&n[u[r]])return n[u[r]]}},y=n.defineClass(function(n,i,r,u){var e,o,s;if(this.urlConnection=n,i!==undefined&&(this.masterKey=i.masterKey,this.resourceTokens=i.resourceTokens,i.permissionFeed))for(this.resourceTokens={},e=0;e<i.permissionFeed.length;e++)o=i.permissionFeed[e].resource.split("/"),s=o[o.length-1],this.resourceTokens[s]=i.permissionFeed[e]._token;this.connectionPolicy=r||new f.ConnectionPolicy;this.defaultHeaders={};this.defaultHeaders[t.HttpHeaders.CacheControl]="no-cache";this.defaultHeaders[t.HttpHeaders.Version]=t.CurrentVersion;u!==undefined&&(this.defaultHeaders[t.HttpHeaders.ConsistencyLevel]=u);t.UserAgent&&(this.defaultHeaders[t.HttpHeaders.UserAgent]=t.UserAgent);this.defaultUrlParams=""},{createDatabase:function(n,t,i){i||(i=t);this.create(n,"/dbs","dbs",undefined,undefined,t,i)},createCollection:function(t,i,r,u){u||(u=r,r={});var f="/"+t+"colls/",e=n.parsePath(t);this.create(i,f,"colls",e.objectBody.id,undefined,r,u)},createDocument:function(t,i,r,u){u||(u=r,r={});i.id!==undefined&&i.id!==""||r.disableAutomaticIdGeneration||(i.id=n.generateGuidId());var f="/"+t+"docs/",e=n.parsePath(t);this.create(i,f,"docs",e.objectBody.id,undefined,r,u)},createAttachment:function(t,i,r,u){u||(u=r,r={});var f="/"+t+"attachments/",e=n.parsePath(t);this.create(i,f,"attachments",e.objectBody.id,undefined,r,u)},createUser:function(t,i,r,u){u||(u=r,r={});var f="/"+t+"users/",e=n.parsePath(t);this.create(i,f,"users",e.objectBody.id,undefined,r,u)},createPermission:function(t,i,r,u){u||(u=r,r={});var f="/"+t+"permissions/",e=n.parsePath(t);this.create(i,f,"permissions",e.objectBody.id,undefined,r,u)},createTrigger:function(t,i,r,u){var o=this,f,e;u||(u=r,r={});i.serverScript?i.body=i.serverScript.toString():i.body&&(i.body=i.body.toString());f=n.parsePath(t);e="/"+t+"triggers/";this.create(i,e,"triggers",f.objectBody.id,undefined,r,u)},createUserDefinedFunction:function(t,i,r,u){u||(u=r,r={});i.serverScript?i.body=i.serverScript.toString():i.body&&(i.body=i.body.toString());var f="/"+t+"udfs/",e=n.parsePath(t);this.create(i,f,"udfs",e.objectBody.id,undefined,r,u)},createStoredProcedure:function(t,i,r,u){u||(u=r,r={});i.serverScript?i.body=i.serverScript.toString():i.body&&(i.body=i.body.toString());var f="/"+t+"sprocs/",e=n.parsePath(t);this.create(i,f,"sprocs",e.objectBody.id,undefined,r,u)},createAttachmentAndUploadMedia:function(i,r,u,f){var e,o,s;f||(f=u,u={});u=u||{};e=n.extend({},this.defaultHeaders);u.slug&&(e[t.HttpHeaders.Slug]=u.slug);e[t.HttpHeaders.ContentType]=u.contentType?u.contentType:t.MediaTypes.OctetStream;o="/"+i+"attachments/";s=n.parsePath(i);this.create(r,o,"attachments",s.objectBody.id,e,u,f)},readDatabase:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.read(u,"dbs",f.objectBody.id,undefined,i,r)},readCollection:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.read(u,"colls",f.objectBody.id,undefined,i,r)},readDocument:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.read(u,"docs",f.objectBody.id,undefined,i,r)},readAttachment:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.read(u,"attachments",f.objectBody.id,undefined,i,r)},readUser:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.read(u,"users",f.objectBody.id,undefined,i,r)},readPermission:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.read(u,"permissions",f.objectBody.id,undefined,i,r)},readTrigger:function(t,i,r){r||(r=i,i={});var u=n.parsePath(t),f="/"+t;this.read(f,"triggers",u.objectBody.id,undefined,i,r)},readUserDefinedFunction:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.read(u,"udfs",f.objectBody.id,undefined,i,r)},readStoredProcedure:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.read(u,"sprocs",f.objectBody.id,undefined,i,r)},readConflict:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.read(u,"conflicts",f.objectBody.id,undefined,i,r)},readDatabases:function(n){return this.queryDatabases(undefined,n)},readCollections:function(n,t){return this.queryCollections(n,undefined,t)},readDocuments:function(n,t){return this.queryDocuments(n,undefined,t)},readAttachments:function(n,t){return this.queryAttachments(n,undefined,t)},readUsers:function(n,t){return this.queryUsers(n,undefined,t)},readPermissions:function(n,t){return this.queryPermissions(n,undefined,t)},readTriggers:function(n,t){return this.queryTriggers(n,undefined,t)},readUserDefinedFunctions:function(n,t){return this.queryUserDefinedFunctions(n,undefined,t)},readStoredProcedures:function(n,t){return this.queryStoredProcedures(n,undefined,t)},readConflicts:function(t,r){var u=this,f="/"+t+"conflicts/",e=n.parsePath(t);return new i(this,"",r,function(n,t){u.queryFeed.call(u,u,f,"conflicts",e.objectBody.id,function(n){return n.Conflicts},function(n,t){return t},"",n,t)})},queryDatabases:function(n,t){var r=this;return new i(this,n,t,function(t,i){r.queryFeed.call(r,r,"/dbs","dbs","",function(n){return n.Databases},function(n,t){return t},n,t,i)})},queryCollections:function(t,r,u){var f=this,e="/"+t+"colls/",o=n.parsePath(t);return new i(this,r,u,function(n,t){f.queryFeed.call(f,f,e,"colls",o.objectBody.id,function(n){return n.DocumentCollections},function(n,t){return t},r,n,t)})},queryDocuments:function(t,r,u){var f=this,e="/"+t+"docs/",o=n.parsePath(t);return new i(this,r,u,function(n,t){f.queryFeed.call(f,f,e,"docs",o.objectBody.id,function(n){return n.Documents},function(n,t){return t},r,n,t)})},queryAttachments:function(t,r,u){var f=this,e="/"+t+"attachments/",o=n.parsePath(t);return new i(this,r,u,function(n,t){f.queryFeed.call(f,f,e,"attachments",o.objectBody.id,function(n){return n.Attachments},function(n,t){return t},r,n,t)})},queryUsers:function(t,r,u){var f=this,e="/"+t+"users/",o=n.parsePath(t);return new i(this,r,u,function(n,t){f.queryFeed.call(f,f,e,"users",o.objectBody.id,function(n){return n.Users},function(n,t){return t},r,n,t)})},queryPermissions:function(t,r,u){var f=this,e=n.parsePath(t),o="/"+t+"permissions/";return new i(this,r,u,function(n,t){f.queryFeed.call(f,f,o,"permissions",e.objectBody.id,function(n){return n.Permissions},function(n,t){return t},r,n,t)})},queryTriggers:function(t,r,u){var f=this,e=n.parsePath(t),o="/"+t+"triggers/";return new i(this,r,u,function(n,t){f.queryFeed.call(f,f,o,"triggers",e.objectBody.id,function(n){return n.Triggers},function(n,t){return t},r,n,t)})},queryUserDefinedFunctions:function(t,r,u){var f=this,e="/"+t+"udfs/",o=n.parsePath(t);return new i(this,r,u,function(n,t){f.queryFeed.call(f,f,e,"udfs",o.objectBody.id,function(n){return n.UserDefinedFunctions},function(n,t){return t},r,n,t)})},queryStoredProcedures:function(t,r,u){var f=this,e=n.parsePath(t),o="/"+t+"sprocs/";return new i(this,r,u,function(n,t){f.queryFeed.call(f,f,o,"sprocs",e.objectBody.id,function(n){return n.StoredProcedures},function(n,t){return t},r,n,t)})},deleteDatabase:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.deleteResource(u,"dbs",f.objectBody.id,undefined,i,r)},deleteCollection:function(t,i,r){var e=this,u,f;r||(r=i,i={});u="/"+t;f=n.parsePath(t);this.deleteResource(u,"colls",f.objectBody.id,undefined,i,r)},deleteDocument:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.deleteResource(u,"docs",f.objectBody.id,undefined,i,r)},deleteAttachment:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.deleteResource(u,"attachments",f.objectBody.id,undefined,i,r)},deleteUser:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.deleteResource(u,"users",f.objectBody.id,undefined,i,r)},deletePermission:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.deleteResource(u,"permissions",f.objectBody.id,undefined,i,r)},deleteTrigger:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.deleteResource(u,"triggers",f.objectBody.id,undefined,i,r)},deleteUserDefinedFunction:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.deleteResource(u,"udfs",f.objectBody.id,undefined,i,r)},deleteStoredProcedure:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.deleteResource(u,"sprocs",f.objectBody.id,undefined,i,r)},deleteConflict:function(t,i,r){r||(r=i,i={});var u="/"+t,f=n.parsePath(t);this.deleteResource(u,"conflicts",f.objectBody.id,undefined,i,r)},replaceDatabase:function(t,i,r,u){u||(u=r,r={});var f="/"+t,e=n.parsePath(t);this.replace(i,f,"dbs",e.objectBody.id,undefined,r,u)},replaceDocument:function(t,i,r,u){u||(u=r,r={});var f="/"+t,e=n.parsePath(t);this.replace(i,f,"docs",e.objectBody.id,undefined,r,u)},replaceAttachment:function(t,i,r,u){u||(u=r,r={});var f="/"+t,e=n.parsePath(t);this.replace(i,f,"attachments",e.objectBody.id,undefined,r,u)},replaceUser:function(t,i,r,u){u||(u=r,r={});var f="/"+t,e=n.parsePath(t);this.replace(i,f,"users",e.objectBody.id,undefined,r,u)},replacePermission:function(t,i,r,u){u||(u=r,r={});var f="/"+t,e=n.parsePath(t);this.replace(i,f,"permissions",e.objectBody.id,undefined,r,u)},replaceTrigger:function(t,i,r,u){u||(u=r,r={});i.serverScript?i.body=i.serverScript.toString():i.body&&(i.body=i.body.toString());var f="/"+t,e=n.parsePath(t);this.replace(i,f,"triggers",e.objectBody.id,undefined,r,u)},replaceUserDefinedFunction:function(t,i,r,u){u||(u=r,r={});i.serverScript?i.body=i.serverScript.toString():i.body&&(i.body=i.body.toString());var f="/"+t,e=n.parsePath(t);this.replace(i,f,"udfs",e.objectBody.id,undefined,r,u)},replaceStoredProcedure:function(t,i,r,u){u||(u=r,r={});i.serverScript?i.body=i.serverScript.toString():i.body&&(i.body=i.body.toString());var f="/"+t,e=n.parsePath(t);this.replace(i,f,"sprocs",e.objectBody.id,undefined,r,u)},readMedia:function(i,r){var s=n.parsePath(i),u="/"+i,f=n.extend({},this.defaultHeaders),e,o;f[t.HttpHeaders.Accept]=t.MediaTypes.Any;e=n.getAttachmentIdFromMediaId(s.objectBody.id);o=n.getHeaders(this,f,"get",u,e,"media",{});this.get(this.urlConnection,u,o,function(n,t,i){if(n)return r(n);r(undefined,t,i)})},updateMedia:function(i,r,u,f){var o,e;f||(f=u,u={});o=this.defaultHeaders;e=n.extend({},o);u.slug&&(e[t.HttpHeaders.Slug]=u.slug);e[t.HttpHeaders.ContentType]=u.contentType?u.contentType:t.MediaTypes.OctetStream;e[t.HttpHeaders.Accept]=t.MediaTypes.Any;var h=this.urlConnection,c=n.parsePath(i),s="/"+i,l=n.getAttachmentIdFromMediaId(c.objectBody.id),a=n.getHeaders(this,e,"put",s,l,"media",u);this.put(h,s,r,a,function(n,t,i){if(n)return f(n);f(undefined,t,i)})},executeStoredProcedure:function(t,i,r){var f,u;r||(r=i,i=null);f=this.defaultHeaders;u={};u=n.extend(u,f);i&&i.constructor!==Array&&(i=[i]);var o=this.urlConnection,e="/"+t,s=n.parsePath(t),h=n.getHeaders(this,u,"post",e,s.objectBody.id,"sprocs",{});this.post(o,e,i,h,function(n,t,i){if(n)return r(n);r(undefined,t,i)})},getDatabaseAccount:function(i){var r=n.getHeaders(this,this.defaultHeaders,"get","","","",{});this.get(this.urlConnection,"",r,function(n,r,u){if(n)return i(n);var e=new f.DatabaseAccount;e.DatabasesLink="/dbs/";e.MediaLink="/media/";e.MaxMediaStorageUsageInMB=u[t.HttpHeaders.MaxMediaStorageUsageInMB];e.CurrentMediaStorageUsageInMB=u[t.HttpHeaders.CurrentMediaStorageUsageInMB];e.CapacityUnitsConsumed=u[t.HttpHeaders.DatabaseAccountCapacityUnitsConsumed];e.CapacityUnitsProvisioned=u[t.HttpHeaders.DatabaseAccountCapacityUnitsProvisioned];e.ConsumedDocumentStorageInMB=u[t.HttpHeaders.DatabaseAccountConsumedDocumentStorageInMB];e.ReservedDocumentStorageInMB=u[t.HttpHeaders.DatabaseAccountReservedDocumentStorageInMB];e.ProvisionedDocumentStorageInMB=u[t.HttpHeaders.DatabaseAccountProvisionedDocumentStorageInMB];e.ConsistencyPolicy=r.userConsistencyPolicy;i(undefined,e,u)})},create:function(t,i,r,u,f,e,o){var c=this,h=this.urlConnection,s;f=f||this.defaultHeaders;s=n.getHeaders(this,f,"post",i,u,r,e);this.post(h,i,t,s,function(n,t,i){if(n)return o(n);o(undefined,t,i)})},replace:function(t,i,r,u,f,e,o){var c=this,h=this.urlConnection,s;f=f||this.defaultHeaders;s=n.getHeaders(this,f,"put",i,u,r,e);this.put(h,i,t,s,function(n,t,i){if(n)return o(n);o(undefined,t,i)})},read:function(t,i,r,u,f,e){var s=this,h=this.urlConnection,o;u=u||this.defaultHeaders;o=n.getHeaders(this,u,"get",t,r,i,f);this.get(this.urlConnection,t,o,function(n,t,i){if(n)return e(n);e(undefined,t,i)})},deleteResource:function(t,i,r,u,f,e){var h=this,s=this.urlConnection,o;u=u||this.defaultHeaders;o=n.getHeaders(this,u,"delete",t,r,i,f);this.delete(s,t,o,e)},get:function(n,t,i,r){return e.request(this.connectionPolicy,"GET",n,t,undefined,this.defaultUrlParams,i,r)},post:function(n,t,i,r,u){return e.request(this.connectionPolicy,"POST",n,t,i,this.defaultUrlParams,r,u)},put:function(n,t,i,r,u){return e.request(this.connectionPolicy,"PUT",n,t,i,this.defaultUrlParams,r,u)},head:function(n,t,i,r){return e.request(this.connectionPolicy,"HEAD",n,t,undefined,this.defaultUrlParams,i,r)},"delete":function(n,t,i,r){return e.request(this.connectionPolicy,"DELETE",n,t,undefined,this.defaultUrlParams,i,r)},queryFeed:function(i,r,u,f,e,o,s,h,c){var p=this,a;c||(c=h,h={});var v=function(t,i,r){if(t)return c(t);var u;u=s?e(i):n.map(e(i),function(n){return o(p,n)});c(undefined,u,r)},y=i.urlConnection,l=n.extend({},i.defaultHeaders);s===undefined?(a=n.getHeaders(i,l,"get",r,f,u,h),i.get(y,r,a,v)):(l[t.HttpHeaders.IsQuery]="true",h.jpath?(l[t.HttpHeaders.Query]=s,a=n.getHeaders(i,l,"get",r,f,u,h),i.get(y,r,a,v)):(l[t.HttpHeaders.ContentType]=t.MediaTypes.SQL,a=n.getHeaders(i,l,"post",r,f,u,h),i.post(y,r,s,a,v)))}});return n.getAttachmentIdFromMediaId=function(n){var t=atob(n),i=20;return t.length>i?btoa(t.substring(0,i)):n},t.UserAgent=null,r.DocumentBase=f,r.RequestHandler=e,r.AuthHandler=h,r._parsePath=n.parsePath,r}).call(this)